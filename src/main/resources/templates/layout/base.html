<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en"
      th:fragment="base(pageTitle, content)">
<head>
    <meta charset="UTF-8" />
    <title th:replace="${pageTitle}">FinSight</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
          darkMode: 'class',
          theme: {
            extend: {}
          }
        }
    </script>
</head>

<body class="bg-gray-100 min-h-screen dark:bg-slate-950 dark:text-slate-50">

<nav
        class="sticky top-0 z-30 border-b border-slate-200 bg-white/80 backdrop-blur-md
           dark:bg-slate-900/80 dark:border-slate-800">

    <div class="max-w-6xl mx-auto px-4">
        <div class="flex h-16 items-center justify-between gap-4">

            <!-- LOGO + TITLE -->
            <a href="/" class="flex items-center gap-3">
                <!-- Light Mode Icon -->
                <img
                        src="/assets/logo-light.png"
                        alt="Finance Tracker Logo"
                        class="h-10 w-10 rounded-xl shadow-sm dark:hidden"
                />

                <!-- Dark Mode Icon -->
                <img
                        src="/assets/logo-dark.png"
                        alt="Finance Tracker Logo"
                        class="h-10 w-10 rounded-xl shadow-sm hidden dark:block"
                />

                <div class="flex flex-col">
                    <span class="text-sm font-semibold tracking-tight text-slate-900 dark:text-slate-50">
                        FinSight
                    </span>
                    <span class="text-[11px] text-slate-500 dark:text-slate-400">
                        Stay on top of your money
                    </span>
                </div>
            </a>

            <!-- NAV LINKS (desktop) -->
            <div
                    class="hidden md:flex items-center gap-1 rounded-full bg-slate-100 px-1 py-1
                       text-xs font-medium text-slate-600
                       dark:bg-slate-800 dark:text-slate-300">
                <a href="/"
                   class="rounded-full px-3 py-1.5 hover:bg-white hover:text-slate-900
                          dark:hover:bg-slate-700 dark:hover:text-slate-50">
                    Home
                </a>
                <a href="/import/"
                   class="rounded-full px-3 py-1.5 hover:bg-white hover:text-slate-900
                          dark:hover:bg-slate-700 dark:hover:text-slate-50">
                    Import
                </a>
                <a href="/auth/register"
                   class="rounded-full px-3 py-1.5 hover:bg-white hover:text-slate-900
                          dark:hover:bg-slate-700 dark:hover:text-slate-50">
                    Register
                </a>
                <a href="/auth/login"
                   class="rounded-full px-3 py-1.5 hover:bg-white hover:text-slate-900
                          dark:hover:bg-slate-700 dark:hover:text-slate-50">
                    Login
                </a>
            </div>

            <!-- RIGHT SIDE: THEME TOGGLE -->
            <div class="flex items-center gap-2">
                <button
                        id="theme-toggle"
                        type="button"
                        class="flex items-center gap-2 rounded-full border border-slate-300 px-3 py-1.5
                           text-xs font-medium
                           bg-white text-slate-700 hover:bg-slate-50
                           shadow-sm
                           dark:bg-slate-800 dark:text-slate-100 dark:border-slate-600 dark:hover:bg-slate-700">
                    <span id="theme-toggle-icon" class="text-sm">ðŸŒ™</span>
                    <span id="theme-toggle-label">Dark</span>
                </button>
            </div>

        </div>
    </div>
</nav>


<main class="px-6 py-8">
    <div class="max-w-5xl mx-auto">
        <th:block th:insert="~{fragments/modal-fragment :: modalFragment}" />

        <th:block th:replace="${content}">
            <p class="text-gray-500">No content provided</p>
        </th:block>
    </div>
</main>

<script>
    (function () {
      const root = document.documentElement; // <html>
      const toggleBtn = document.getElementById('theme-toggle');
      const iconSpan = document.getElementById('theme-toggle-icon');
      const labelSpan = document.getElementById('theme-toggle-label');

      // 1ï¸âƒ£ Cek preferensi di localStorage
      const storedTheme = localStorage.getItem('theme');

      if (storedTheme === 'dark') {
        root.classList.add('dark');
      } else if (storedTheme === 'light') {
        root.classList.remove('dark');
      } else {
        // 2ï¸âƒ£ Kalo ga ada di localStorage, fallback ke OS
        if (window.matchMedia &&
            window.matchMedia('(prefers-color-scheme: dark)').matches) {
          root.classList.add('dark');
        } else {
          root.classList.remove('dark');
        }
      }

      // Update tampilan icon + teks
      function syncButtonUI() {
        const isDark = root.classList.contains('dark');
        if (isDark) {
          iconSpan.textContent = 'â˜€ï¸';
          labelSpan.textContent = 'Light';
        } else {
          iconSpan.textContent = 'ðŸŒ™';
          labelSpan.textContent = 'Dark';
        }
      }

      syncButtonUI();

      // 3ï¸âƒ£ Event: kalau tombol di-klik â†’ toggle theme + simpen ke localStorage
      if (toggleBtn) {
        toggleBtn.addEventListener('click', () => {
          const isDarkNow = root.classList.toggle('dark');
          localStorage.setItem('theme', isDarkNow ? 'dark' : 'light');
          syncButtonUI();
        });
      }
    })();



</script>

</body>
</html>
